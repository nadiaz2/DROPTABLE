
let webSocket = new WebSocket('ws://'+window.location.host)

//receiving
webSocket.onmessage = (event) => {
        //json convert to variables
        console.log(event.data);
    };

await until(() => webSocket.readyState == WebSocket.OPEN)

function until(conditionFunction) {

    const poll = resolve => {
        if(conditionFunction()) resolve();
        else setTimeout(_ => poll(resolve), 100);
    }

    return new Promise(poll);

}

//sending
webSocket.send(JSON.stringify(/*stuff*/))

{
    Name: xxx
    Message:
}